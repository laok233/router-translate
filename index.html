<!DOCTYPE html>
<html>
<head>
    <title>router translate</title>
</head>

<body>
    <h1>Router Translate</h1>
    <p>random language:</p>
    <textarea placeholder="random language" rows="15" cols="80" id="random_language"></textarea>
    <br>
    <button onclick="trans()">translate</button>
    <p>router:</p>
    <p id="router_language"></p>
    <p id="test_writeTranslation"></p>
    <br>
    <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">don't click this</a>
    <script>
        function trans() {
            var x = document.getElementById("router_language");
            var text = document.getElementById("random_language").value;
            //var text = text.trim(); //remove space
            //var l = text.length % 6; 
            //var l = l + 1;
            var translated = readTranslation(text); //fing a translation if already translated
            if (translated == undefined) {
                var r = random_caseR();
                var o = random_caseO();
                var u = random_caseU();
                var t = random_caseT();
                var e = random_caseE();
                var r_ = random_caseR_();
                var result = r+o+u+t+e+r_;
                writeTranslation(result, text);
            } else var result = translated;

            x.innerHTML = result;
            
            //document.getElementById("test_writeTranslation").innerHTML = test;
        }

        function random_caseR() {
            if (Math.random() < 0.50) {
                return "r";
            } else {
                return "R";
            }
        }

        function random_caseO() {
            if (Math.random() < 0.50) {
                return "o";
            } else {
                return "O";
            }
        }

        function random_caseU() {
            if (Math.random() < 0.50) {
                return "u";
            } else {
                return "U";
            }
        }

        function random_caseT() {
            if (Math.random() < 0.50) {
                return "t";
            } else {
                return "T";
            }
        }
        
        function random_caseE() {
            if (Math.random() < 0.50) {
                return "e";
            } else {
                return "E";
            }
        }

        function random_caseR_() {
            if (Math.random() < 0.50) {
                return "r";
            } else {
                return "R";
            }
        }

        function writeTranslation(result, text) {
            var retrievedData = sessionStorage.getItem("translations");
            var g = JSON.parse(retrievedData);

            if(g && g.length) {
                g.push(text);
                var i = g.length - 1;
                g[i] = {text: text, router: result};

            } else {
                var g = [];
                g.push(text);
                var i = g.length - 1;
                g[i] = {text: text, router: result};
            }

            sessionStorage.setItem("translations", JSON.stringify(g));
            
        }

        function readTranslation(text) {
            //return undefined;
            var retrievedData = sessionStorage.getItem("translations");
            var g = JSON.parse(retrievedData);
            //console.log(g);
            if (g == null) {
                return undefined;
            }

            var f = g.find(y => y.text === text);
            if (f == undefined) {
                return undefined;
            }

            //console.log(f);
            var j = f.router;
            //console.log("j is ", j);
            return j
        }

    </script>
</body>
</html>
